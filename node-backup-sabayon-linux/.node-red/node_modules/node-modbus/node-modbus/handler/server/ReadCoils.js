"use strict";var stampit=require("stampit");module.exports=stampit().init(function(){var t=function(){this.log.debug("initiating read coils request handler."),this.responseDelay||(this.responseDelay=0),this.setRequestHandler(1,e)}.bind(this),e=function(t,e){setTimeout(function(){if(this.log.debug("handling read coils request."),5!==t.length){var i=Buffer.allocUnsafe(2);return i.writeUInt8(129,0),i.writeUInt8(2,1),void e(i)}var r=t.readUInt16BE(1),n=t.readUInt16BE(3);this.emit("readCoilsRequest",r,n);var s=this.getCoils();if(r>8*s.length||r+n>8*s.length){var a=Buffer.allocUnsafe(2);return a.writeUInt8(129,0),a.writeUInt8(2,1),void e(a)}var l=0,o=0,u=2,h=Math.ceil(n/8),d=Buffer.allocUnsafe(2+h);d.writeUInt8(1,0),d.writeUInt8(h,1);for(var f=r;f<r+n;f+=1){s.readUInt8(Math.floor(f/8))&1<<f%8&&(l+=1<<o%8),(o+=1)%8!=0&&f!==r+n-1||(d.writeUInt8(l,u),l=0,u+=1)}e(d)}.bind(this),this.responseDelay)}.bind(this);t()});
//# sourceMappingURL=../../maps/handler/server/ReadCoils.js.map
