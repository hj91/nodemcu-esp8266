"use strict";var stampit=require("stampit"),handler=stampit().init(function(){var t=function(){this.log.debug("initiating read discrete inputs request handler."),this.responseDelay||(this.responseDelay=0),this.setRequestHandler(2,e)}.bind(this),e=function(t,e){setTimeout(function(){if(this.log.debug("handling read discrete inputs request."),5!==t.length){this.log.debug("wrong pdu length.");var i=Buffer.allocUnsafe(2);return i.writeUInt8(130,0),i.writeUInt8(2,1),void e(i)}var n=t.readUInt16BE(1),r=t.readUInt16BE(3);this.emit("readDiscreteInputsRequest",n,r);var s=this.getInput();if(n>8*s.length||n+r>8*s.length){this.log.debug("wrong pdu length.");var a=Buffer.allocUnsafe(2);return a.writeUInt8(130,0),a.writeUInt8(2,1),void e(a)}var u=0,l=0,d=2,h=Math.ceil(r/8),o=Buffer.allocUnsafe(2+h);o.writeUInt8(2,0),o.writeUInt8(h,1);for(var g=n;g<n+r;g+=1){s.readUInt8(Math.floor(g/8))&1<<g%8&&(u+=1<<l%8),(l+=1)%8!=0&&g!==n+r-1||(o.writeUInt8(u,d),u=0,d+=1)}e(o)}.bind(this),this.responseDelay)}.bind(this);t()});module.exports=handler;
//# sourceMappingURL=../../maps/handler/server/ReadDiscreteInputs.js.map
