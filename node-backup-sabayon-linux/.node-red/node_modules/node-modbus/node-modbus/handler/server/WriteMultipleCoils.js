"use strict";var stampit=require("stampit");module.exports=stampit().init(function(){var t=function(){this.log.debug("initiating write multiple coils request handler."),this.responseDelay||(this.responseDelay=0),this.setRequestHandler(15,e)}.bind(this),e=function(t,e){setTimeout(function(){if(this.log.debug("handling write multiple coils request."),t.length<3){var i=Buffer.allocUnsafe(2);return i.writeUInt8(143,0),i.writeUInt8(2,1),void e(i)}var r=t.readUInt16BE(1),n=t.readUInt16BE(3),s=t.readUInt8(5);this.emit("preWriteMultipleCoilsRequest",r,n,s);var a=this.getCoils();if(r>8*a.length||r+n>8*a.length){var o=Buffer.allocUnsafe(2);return o.writeUInt8(143,0),o.writeUInt8(2,1),void e(o)}var l=Buffer.allocUnsafe(5);l.writeUInt8(15,0),l.writeUInt16BE(r,1),l.writeUInt16BE(n,3);for(var u=void 0,h=void 0,d=t.readUInt8(6),f=0,U=r;U<r+n;U+=1)u=a.readUInt8(Math.floor(U/8)),h=Math.pow(2,f%8)&d?u|Math.pow(2,U%8):u&~Math.pow(2,U%8),a.writeUInt8(h,Math.floor(U/8)),(f+=1)%8==0&&f<n&&(d=t.readUInt8(6+Math.floor(f/8)));this.emit("postWriteMultipleCoilsRequest",r,n,s),e(l)}.bind(this),this.responseDelay)}.bind(this);t()});
//# sourceMappingURL=../../maps/handler/server/WriteMultipleCoils.js.map
