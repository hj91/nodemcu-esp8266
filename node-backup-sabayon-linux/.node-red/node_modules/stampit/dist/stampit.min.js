"use strict";function _interopRequireDefault(t){return t&&t.__esModule?t:{"default":t}}function isThenable(t){return t&&_lodashLangIsFunction2["default"](t.then)}function extractFunctions(){for(var t=[],n=arguments.length,e=Array(n),a=0;n>a;a++)e[a]=arguments[a];return _lodashLangIsFunction2["default"](e[0])?_lodashCollectionForEach2["default"](e,function(n){_lodashLangIsFunction2["default"](n)&&t.push(n)}):_lodashLangIsObject2["default"](e[0])&&_lodashCollectionForEach2["default"](e,function(n){_lodashCollectionForEach2["default"](n,function(n){_lodashLangIsFunction2["default"](n)&&t.push(n)})}),t}function addMethods(t){for(var n=arguments.length,e=Array(n>1?n-1:0),a=1;n>a;a++)e[a-1]=arguments[a];return _supermixer.mixinFunctions.apply(void 0,[t.methods].concat(e))}function addRefs(t){for(var n=arguments.length,e=Array(n>1?n-1:0),a=1;n>a;a++)e[a-1]=arguments[a];return t.refs=t.state=_supermixer.mixin.apply(void 0,[t.refs].concat(e)),t.refs}function addInit(t){for(var n=arguments.length,e=Array(n>1?n-1:0),a=1;n>a;a++)e[a-1]=arguments[a];var r=extractFunctions.apply(void 0,e);return t.init=t.enclose=t.init.concat(r),t.init}function addProps(t){for(var n=arguments.length,e=Array(n>1?n-1:0),a=1;n>a;a++)e[a-1]=arguments[a];return _supermixer.merge.apply(void 0,[t.props].concat(e))}function addStatic(t){for(var n=arguments.length,e=Array(n>1?n-1:0),a=1;n>a;a++)e[a-1]=arguments[a];return _supermixer.mixin.apply(void 0,[t["static"]].concat(e))}function cloneAndExtend(t,n){for(var e=stampit(t),a=arguments.length,r=Array(a>2?a-2:0),i=2;a>i;i++)r[i-2]=arguments[i];return n.apply(void 0,[e.fixed].concat(r)),e}function _compose(){for(var t=stampit(),n=arguments.length,e=Array(n),a=0;n>a;a++)e[a]=arguments[a];return _lodashCollectionForEach2["default"](e,function(n){n&&n.fixed&&(addMethods(t.fixed,n.fixed.methods),addRefs(t.fixed,n.fixed.refs||n.fixed.state),addInit(t.fixed,n.fixed.init||n.fixed.enclose),addProps(t.fixed,n.fixed.props),addStatic(t.fixed,n.fixed["static"]))}),_supermixer.mixin(t,t.fixed["static"])}function isStamp(t){return _lodashLangIsFunction2["default"](t)&&_lodashLangIsFunction2["default"](t.methods)&&(_lodashLangIsFunction2["default"](t.refs)||_lodashLangIsFunction2["default"](t.state))&&(_lodashLangIsFunction2["default"](t.init)||_lodashLangIsFunction2["default"](t.enclose))&&_lodashLangIsFunction2["default"](t.props)&&_lodashLangIsFunction2["default"](t["static"])&&_lodashLangIsObject2["default"](t.fixed)}function convertConstructor(t){var n=stampit();return n.fixed.refs=n.fixed.state=_supermixer.mergeChainNonFunctions(n.fixed.refs,t.prototype),_supermixer.mixin(n,_supermixer.mixin(n.fixed["static"],t)),_supermixer.mixinChainFunctions(n.fixed.methods,t.prototype),addInit(n.fixed,function(n){var e=n.instance,a=n.args;return t.apply(e,a)}),n}function shortcutMethod(t){for(var n=stampit(),e=arguments.length,a=Array(e>1?e-1:0),r=1;e>r;r++)a[r-1]=arguments[r];return t.apply(void 0,[n.fixed].concat(a)),n}function mixinWithConsoleWarning(){return console.log("stampit.mixin(), .mixIn(), .extend(), and .assign() are deprecated.","Use Object.assign or _.assign instead"),_supermixer.mixin.apply(this,arguments)}Object.defineProperty(exports,"__esModule",{value:!0});var _lodashCollectionForEach=require("lodash/collection/forEach"),_lodashCollectionForEach2=_interopRequireDefault(_lodashCollectionForEach),_lodashLangIsFunction=require("lodash/lang/isFunction"),_lodashLangIsFunction2=_interopRequireDefault(_lodashLangIsFunction),_lodashLangIsObject=require("lodash/lang/isObject"),_lodashLangIsObject2=_interopRequireDefault(_lodashLangIsObject),_supermixer=require("supermixer"),create=Object.create,stampit=function(t){var n={methods:{},refs:{},init:[],props:{},"static":{}};n.state=n.refs,n.enclose=n.init,t&&(addMethods(n,t.methods),addRefs(n,t.refs),addInit(n,t.init),addProps(n,t.props),addStatic(n,t["static"]));var e=function(t){for(var a=arguments.length,r=Array(a>1?a-1:0),i=1;a>i;i++)r[i-1]=arguments[i];var o=_supermixer.mixin(create(n.methods),n.refs,t);_supermixer.mergeUnique(o,n.props);var s=null;return n.init.length>0&&_lodashCollectionForEach2["default"](n.init,function(t){if(_lodashLangIsFunction2["default"](t))if(s)s=s.then(function(n){o=n||o;var a=t.call(o,{args:r,instance:o,stamp:e});return a?isThenable(a)?a:o=a:o});else{var n=t.call(o,{args:r,instance:o,stamp:e});if(!n)return;if(!isThenable(n))return void(o=n);s=n}}),s?s.then(function(t){return t||o}):o},a=cloneAndExtend.bind(null,n,addRefs),r=cloneAndExtend.bind(null,n,addInit);return _supermixer.mixin(e,{create:e,fixed:n,methods:cloneAndExtend.bind(null,n,addMethods),refs:a,state:a,init:r,enclose:r,props:cloneAndExtend.bind(null,n,addProps),"static":function(){for(var t=arguments.length,n=Array(t),a=0;t>a;a++)n[a]=arguments[a];var r=cloneAndExtend.apply(void 0,[e.fixed,addStatic].concat(n));return _supermixer.mixin(r,r.fixed["static"])},compose:function(){for(var t=arguments.length,n=Array(t),a=0;t>a;a++)n[a]=arguments[a];return _compose.apply(void 0,[e].concat(n))}},n["static"])};exports["default"]=_supermixer.mixin(stampit,{methods:shortcutMethod.bind(null,addMethods),refs:shortcutMethod.bind(null,addRefs),init:shortcutMethod.bind(null,addInit),props:shortcutMethod.bind(null,addProps),"static":function(){for(var t=arguments.length,n=Array(t),e=0;t>e;e++)n[e]=arguments[e];var a=shortcutMethod.apply(void 0,[addStatic].concat(n));return _supermixer.mixin(a,a.fixed["static"])},compose:_compose,mixin:mixinWithConsoleWarning,extend:mixinWithConsoleWarning,mixIn:mixinWithConsoleWarning,assign:mixinWithConsoleWarning,isStamp:isStamp,convertConstructor:convertConstructor}),module.exports=exports["default"];