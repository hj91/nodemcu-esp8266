/* eslint-disable no-console, spaced-comment */

// create an empty modbus client
//var ModbusRTU = require("modbus-serial");
var ModbusRTU = require("../index");
var client = new ModbusRTU();

// open connection to a serial port
client.connectTCP("modbus.local", { port: 502 })
    .then(setClient)
    .then(function() {
        console.log("Connected"); })
    .catch(function(e) {
        console.log(e.message); });

function setClient() {
    // set the client's unit id
    // set a timout for requests default is null (no timeout)
    client.setID(1);

    // run program
    run();
}

function run() {
    // read the 4 registers starting at address 5
    //client.writeCoil(5, false).catch(console.log);
    client.writeCoil(4, false).catch(console.log);

    setTimeout(close, 10000);
}

function close() {
    client.close();
}
