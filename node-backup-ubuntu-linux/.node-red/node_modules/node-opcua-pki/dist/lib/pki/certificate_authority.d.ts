import { ErrorCallback, Filename, KeySize } from "./common";
import { Params } from "./toolbox";
export interface CertificateAuthorityOptions {
    keySize: KeySize;
    location: string;
}
export declare class CertificateAuthority {
    readonly keySize: KeySize;
    readonly location: string;
    constructor(options: CertificateAuthorityOptions);
    readonly rootDir: string;
    readonly configFile: string;
    readonly caCertificate: string;
    readonly revocationList: string;
    readonly caCertificateWithCrl: string;
    initialize(callback: ErrorCallback): void;
    constructCACertificateWithCRL(callback: ErrorCallback): void;
    constructCertificateChain(certificate: Filename, callback: ErrorCallback): void;
    createSelfSignedCertificate(certificateFile: Filename, privateKey: Filename, params: Params, callback: ErrorCallback): void;
    /**
     * revoke a certificate and update the CRL
     *
     * @method revokeCertificate
     * @param certificate {String} the certificate to revoke
     * @param params {Object}
     * @paral [params.reason = "keyCompromise" {String}]
     * @param callback {Function}
     * @async
     */
    revokeCertificate(certificate: Filename, params: Params, callback: ErrorCallback): void;
    /**
     *
     * @param certificate            {String} the certificate filename to generate
     * @param certificateSigningRequestFilename               {String} the certificate signing request
     * @param params                 {Object}
     * @param params.applicationUri  {String} the applicationUri
     * @param params.startDate       {Date}   startDate of the certificate
     * @param params.validity        {Number} number of day of validity of the cerificate
     * @param callback               {Function}
     */
    signCertificateRequest(certificate: Filename, certificateSigningRequestFilename: Filename, params: Params, callback: (err: Error | null, certificate?: Filename) => void): void;
    verifyCertificate(certificate: Filename, callback: ErrorCallback): void;
}
