"use strict";module.exports=function(r){var n=require("./core/bacnet-core");r.nodes.registerType("BACnet-Read",function(e){r.nodes.createNode(this,e),this.name=e.name,this.objectType=parseInt(e.objectType),this.propertyId=parseInt(e.propertyId),this.multipleRead=e.multipleRead,this.instance=r.nodes.getNode(e.instance),this.objectInstance=this.instance.instanceAddress||0,this.device=r.nodes.getNode(e.device),this.deviceIPAddress=this.device.deviceAddress||"127.0.0.1",this.connector=r.nodes.getNode(e.server);var a=this;a.status({fill:"green",shape:"dot",text:"active"}),a.on("input",function(o){if(a.connector){var e=o.payload.options||{};if(a.multipleRead){n.internalDebugLog("Multiple Read");var r=[{objectId:{type:a.objectType,instance:parseInt(a.objectInstance)},properties:[{id:parseInt(a.propertyId)}]}];try{n.internalDebugLog("readPropertyMultiple default requestArray: "+JSON.stringify(r)),n.internalDebugLog("readPropertyMultiple msg.payload.requestArray: "+JSON.stringify(o.payload.requestArray)),n.internalDebugLog("readProperty node.propertyId: "+a.propertyId)}catch(e){n.internalDebugLog("writeProperty error: "+e)}a.connector.client.readPropertyMultiple(o.payload.deviceIPAddress||a.deviceIPAddress,o.payload.requestArray||r,e,function(e,r){if(e){var t=n.translateErrorMessage(e);n.internalDebugLog(t),a.error(t,o)}else o.input=o.payload,o.payload=r,a.send(o)})}else{n.internalDebugLog("Read");var t={type:a.objectType,instance:parseInt(a.objectInstance)};try{n.internalDebugLog("readProperty default objectId: "+JSON.stringify(t)),n.internalDebugLog("readProperty msg.payload.objectId: "+JSON.stringify(o.payload.objectId)),n.internalDebugLog("readProperty node.propertyId: "+a.propertyId)}catch(e){n.internalDebugLog("writeProperty error: "+e)}a.connector.client.readProperty(o.payload.deviceIPAddress||a.deviceIPAddress,o.payload.objectId||t,o.payload.propertyId||a.propertyId,e,function(e,r){if(e){var t=n.translateErrorMessage(e);n.internalDebugLog(t),a.error(t,o)}else o.input=o.payload,o.payload=r,a.send(o)})}}else a.error(new Error("Client Not Ready To Read"),o)})})};
//# sourceMappingURL=maps/bacnet-read.js.map
