"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}require("source-map-support").install();var de=de||{biancoroyal:{opcua:{iiot:{core:{}}}}};de.biancoroyal.opcua.iiot.core.nodeOPCUA=de.biancoroyal.opcua.iiot.core.nodeOPCUA||require("node-opcua"),de.biancoroyal.opcua.iiot.core.nodeOPCUAId=de.biancoroyal.opcua.iiot.core.nodeOPCUAId||require("node-opcua-nodeid"),de.biancoroyal.opcua.iiot.core.internalDebugLog=de.biancoroyal.opcua.iiot.core.internalDebugLog||require("debug")("opcuaIIoT:core"),de.biancoroyal.opcua.iiot.core.detailDebugLog=de.biancoroyal.opcua.iiot.core.detailDebugLog||require("debug")("opcuaIIoT:core:details"),de.biancoroyal.opcua.iiot.core.specialDebugLog=de.biancoroyal.opcua.iiot.core.specialDebugLog||require("debug")("opcuaIIoT:core:special"),de.biancoroyal.opcua.iiot.core.OBJECTS_ROOT=de.biancoroyal.opcua.iiot.core.OBJECTS_ROOT||"ns=0;i=84",de.biancoroyal.opcua.iiot.core.TEN_SECONDS_TIMEOUT=de.biancoroyal.opcua.iiot.core.TEN_SECONDS_TIMEOUT||10,de.biancoroyal.opcua.iiot.core.RUNNING_STATE=de.biancoroyal.opcua.iiot.core.RUNNING_STATE||"SESSIONACTIVE",de.biancoroyal.opcua.iiot.core.os=de.biancoroyal.opcua.iiot.core.os||require("os"),de.biancoroyal.opcua.iiot.core.assert=de.biancoroyal.opcua.iiot.core.assert||require("better-assert"),de.biancoroyal.opcua.iiot.core.underscore=de.biancoroyal.opcua.iiot.core.underscore||require("underscore"),de.biancoroyal.opcua.iiot.core.isWindows=de.biancoroyal.opcua.iiot.core.isWindows||/^win/.test(de.biancoroyal.opcua.iiot.core.os.platform()),de.biancoroyal.opcua.iiot.core.FAKTOR_SEC_TO_MSEC=de.biancoroyal.opcua.iiot.core.FAKTOR_SEC_TO_MSEC||1e3,de.biancoroyal.opcua.iiot.core.DEFAULT_TIMEOUT=de.biancoroyal.opcua.iiot.core.DEFAULT_TIMEOUT||1e3,de.biancoroyal.opcua.iiot.core.internalDebugLog(de.biancoroyal.opcua.iiot.core.os.endianness()),de.biancoroyal.opcua.iiot.core.internalDebugLog(de.biancoroyal.opcua.iiot.core.os.hostname()),de.biancoroyal.opcua.iiot.core.internalDebugLog(de.biancoroyal.opcua.iiot.core.os.platform()),de.biancoroyal.opcua.iiot.core.internalDebugLog(de.biancoroyal.opcua.iiot.core.os.type()),de.biancoroyal.opcua.iiot.core.internalDebugLog(de.biancoroyal.opcua.iiot.core.os.arch()),de.biancoroyal.opcua.iiot.core.getPathFromRequireResolve=function(e){var a="";return a=this.isWindows?e.replace("\\index.js",""):e.replace("/index.js",""),this.internalDebugLog("path to node-opcua: "+a),a},de.biancoroyal.opcua.iiot.core.getNodeOPCUAPath=function(){return this.getPathFromRequireResolve(require.resolve("node-opcua"))},de.biancoroyal.opcua.iiot.core.getNodeOPCUAClientPath=function(){return this.getPathFromRequireResolve(require.resolve("node-opcua-client"))},de.biancoroyal.opcua.iiot.core.getNodeOPCUAServerPath=function(){return this.getPathFromRequireResolve(require.resolve("node-opcua-server"))},de.biancoroyal.opcua.iiot.core.getTimeUnitName=function(e){var a="";switch(e){case"ms":a="msec.";break;case"s":a="sec.";break;case"m":a="min.";break;case"h":a="h."}return a},de.biancoroyal.opcua.iiot.core.calcMillisecondsByTimeAndUnit=function(e,a){var o;switch(a){case"ms":o=e;break;case"s":o=1e3*e;break;case"m":o=6e4*e;break;case"h":o=36e5*e;break;default:o=1e4}return o},de.biancoroyal.opcua.iiot.core.buildBrowseMessage=function(e){return{topic:e,nodeId:"",browseName:"",nodeClassType:"",typeDefinition:"",payload:""}},de.biancoroyal.opcua.iiot.core.toInt32=function(e){var a=e;return a>=Math.pow(2,15)?a=e-Math.pow(2,16):a},de.biancoroyal.opcua.iiot.core.getNodeStatus=function(e,a){var o="yellow",t="ring";switch(e){case"initialize":case"connecting":o="yellow";break;case"connected":case"keepalive":case"subscribe":case"started":a||(e="active",t="dot"),o="green";break;case"active":case"subscribed":case"listening":o="green",t="dot";break;case"disconnected":case"terminated":o="red";break;case"waiting":o="blue",t="dot",e="waiting ...";break;case"error":o="red",t="dot";break;default:e||(o="blue",e="waiting ...")}return{fill:o,shape:t,status:e}},de.biancoroyal.opcua.iiot.core.buildNewVariant=function(a,o){var e=de.biancoroyal.opcua.iiot.core.nodeOPCUA,t=null;switch(this.detailDebugLog("buildNewVariant datatype: "+a+" value:"+o),a){case"Float":case e.DataType.Float:t={dataType:e.DataType.Float,value:parseFloat(o)};break;case"Double":case e.DataType.Double:t={dataType:e.DataType.Double,value:parseFloat(o)};break;case"UInt16":case e.DataType.UInt16:var n=new Uint16Array([o]);t={dataType:e.DataType.UInt16,value:n[0]};break;case"UInt32":case e.DataType.UInt32:var i=new Uint32Array([o]);t={dataType:e.DataType.UInt32,value:i[0]};break;case"Int32":case e.DataType.Int32:t={dataType:e.DataType.Int32,value:parseInt(o)};break;case"Int16":case e.DataType.Int16:t={dataType:e.DataType.Int16,value:parseInt(o)};break;case"Int64":case e.DataType.Int64:t={dataType:e.DataType.Int64,value:parseInt(o)};break;case"Boolean":case e.DataType.Boolean:t=o&&"false"!==o?{dataType:e.DataType.Boolean,value:!0}:{dataType:e.DataType.Boolean,value:!1};break;case"LocalizedText":case e.DataType.LocalizedText:t={dataType:e.DataType.LocalizedText,value:JSON.parse(o)};break;case"DateTime":case e.DataType.DateTime:t={dataType:e.DataType.DateTime,value:new Date(o)};break;default:if(""!==a)this.getBasicDataTypes().forEach(function(e){e.name!==a&&e.dataType!==a||(t={dataType:e.dataType,value:o})});else t={dataType:e.DataType.String,value:o}}return this.detailDebugLog("buildNewVariant variantValue: "+JSON.stringify(t)),t},de.biancoroyal.opcua.iiot.core.getVariantValue=function(e,a){var o=de.biancoroyal.opcua.iiot.core.nodeOPCUA;switch(e){case"Float":case"Double":case o.DataType.Double:return parseFloat(a);case"UInt16":case o.DataType.UInt16:return new Uint16Array([a])[0];case"UInt32":case o.DataType.UInt32:return new Uint32Array([a])[0];case"Int16":case o.DataType.Int16:case"Int32":case"Integer":case o.DataType.Int32:case"Int64":case o.DataType.Int64:return parseInt(a);case"Boolean":case o.DataType.Boolean:return a&&"false"!==a;case"DateTime":case o.DataType.DateTime:return new Date(a);case"String":case o.DataType.String:return"string"!=typeof a?a.toString():a;default:return a}},de.biancoroyal.opcua.iiot.core.getBasicDataTypes=function(){var e=de.biancoroyal.opcua.iiot.core.nodeOPCUA;return[{name:"Null",dataType:e.DataType.Null},{name:"Boolean",dataType:e.DataType.Boolean},{name:"SByte",dataType:e.DataType.SByte},{name:"Byte",dataType:e.DataType.Byte},{name:"Int16",dataType:e.DataType.Int16},{name:"UInt16",dataType:e.DataType.UInt16},{name:"Int32",dataType:e.DataType.Int32},{name:"UInt32",dataType:e.DataType.UInt32},{name:"Int64",dataType:e.DataType.Int64},{name:"UInt64",dataType:e.DataType.UInt64},{name:"Float",dataType:e.DataType.Float},{name:"Double",dataType:e.DataType.Double},{name:"DateTime",dataType:e.DataType.DateTime},{name:"String",dataType:e.DataType.String},{name:"Guid",dataType:e.DataType.Guid},{name:"ByteString",dataType:e.DataType.ByteString},{name:"XmlElement",dataType:e.DataType.XmlElement},{name:"NodeId",dataType:e.DataType.NodeId},{name:"ExpandedNodeId",dataType:e.DataType.ExpandedNodeId},{name:"StatusCode",dataType:e.DataType.StatusCode},{name:"LocalizedText",dataType:e.DataType.LocalizedText},{name:"ExtensionObject",dataType:e.DataType.ExtensionObject},{name:"DataValue",dataType:e.DataType.DataValue},{name:"Variant",dataType:e.DataType.Variant},{name:"DiagnosticInfo",dataType:e.DataType.DiagnosticInfo}]},de.biancoroyal.opcua.iiot.core.convertDataValue=function(e){return de.biancoroyal.opcua.iiot.core.convertDataValueByDataType(e,e.dataType)},de.biancoroyal.opcua.iiot.core.convertDataValueByDataType=function(e,a){var o=de.biancoroyal.opcua.iiot.core.nodeOPCUA,t=null;if(!e.hasOwnProperty("value"))return this.specialDebugLog("value has no value and that is not allowed "+JSON.stringify(e)),e;var n=_typeof(e.value);this.detailDebugLog("convertDataValue: "+JSON.stringify(e)+" value origin type "+n+" convert to "+a);try{switch(a){case"NodeId":case o.DataType.NodeId:t=e.value.toString();break;case"NodeIdType":case o.DataType.NodeIdType:t=e.value instanceof Buffer?e.value.toString():e.value;break;case"ByteString":case o.DataType.ByteString:t=e.value;break;case"Byte":case o.DataType.Byte:t="boolean"===n?e.value?1:0:parseInt(e.value);break;case o.DataType.QualifiedName:t=e.value.toString();break;case"LocalizedText":case o.DataType.LocalizedText:t=e.value;break;case"Float":case o.DataType.Float:t=isNaN(e.value)?e.value:parseFloat(e.value);break;case"Double":case o.DataType.Double:t=isNaN(e.value)?e.value:parseFloat(e.value);break;case"UInt16":case o.DataType.UInt16:t=new Uint16Array([e.value])[0];break;case"UInt32":case o.DataType.UInt32:t=new Uint32Array([e.value])[0];break;case"Int16":case o.DataType.Int16:case"Int32":case o.DataType.Int32:case"Int64":case o.DataType.Int64:t="boolean"===n?e.value?1:0:isNaN(e.value)?e.value:parseInt(e.value);break;case"Boolean":case o.DataType.Boolean:t="boolean"===n?e.value:isNaN(e.value)?e.value&&"false"!==e.value.toString().toLowerCase():e.value;break;case"String":case o.DataType.String:t="string"!==n?e.value.toString():e.value;break;case"Null":case o.DataType.Null:t=null;break;default:this.internalDebugLog("convertDataValue unused DataType: "+a),t=e.hasOwnProperty("value")?e.value:null}}catch(e){this.detailDebugLog("convertDataValue "+e)}return this.detailDebugLog("convertDataValue is: "+t),t},de.biancoroyal.opcua.iiot.core.regex_ns_i=/ns=([0-9]+);i=([0-9]+)/,de.biancoroyal.opcua.iiot.core.regex_ns_s=/ns=([0-9]+);s=(.*)/,de.biancoroyal.opcua.iiot.core.regex_ns_b=/ns=([0-9]+);b=(.*)/,de.biancoroyal.opcua.iiot.core.regex_ns_g=/ns=([0-9]+);g=(.*)/,de.biancoroyal.opcua.iiot.core.parseNamspaceFromMsgTopic=function(e){var a=null;return e&&e.topic&&(a=e.topic.substring(3,e.topic.indexOf(";"))),a},de.biancoroyal.opcua.iiot.core.parseNamspaceFromItemNodeId=function(e){var a=null,o=e.nodeId||e;return o&&(a=o.substring(3,o.indexOf(";"))),a},de.biancoroyal.opcua.iiot.core.parseForNodeIdentifier=function(e){var a=null;return e&&(a=e.includes(";i=")?{identifier:parseInt(e.substring(e.indexOf(";i=")+3)),type:de.biancoroyal.opcua.iiot.core.nodeOPCUAId.NodeIdType.NUMERIC}:e.includes(";g=")?{identifier:e.substring(e.indexOf(";g=")+3),type:de.biancoroyal.opcua.iiot.core.nodeOPCUAId.NodeIdType.GUID}:e.includes(";b=")?{identifier:e.substring(e.indexOf(";b=")+3),type:de.biancoroyal.opcua.iiot.core.nodeOPCUAId.NodeIdType.BYTESTRING}:{identifier:e.substring(e.indexOf(";s=")+3),type:de.biancoroyal.opcua.iiot.core.nodeOPCUAId.NodeIdType.STRING}),a},de.biancoroyal.opcua.iiot.core.parseIdentifierFromMsgTopic=function(e){return this.parseForNodeIdentifier(e.topic)},de.biancoroyal.opcua.iiot.core.parseIdentifierFromItemNodeId=function(e){return this.parseForNodeIdentifier(e.nodeId||e)},de.biancoroyal.opcua.iiot.core.newOPCUANodeIdFromItemNodeId=function(e){var a=de.biancoroyal.opcua.iiot.core.parseNamspaceFromItemNodeId(e),o=de.biancoroyal.opcua.iiot.core.parseIdentifierFromItemNodeId(e);return this.internalDebugLog("newOPCUANodeIdFromItemNodeId: "+JSON.stringify(e)+" -> "+JSON.stringify(o)+" namespace:"+a),new de.biancoroyal.opcua.iiot.core.nodeOPCUAId.NodeId(o.type,o.identifier,a)},de.biancoroyal.opcua.iiot.core.newOPCUANodeIdFromMsgTopic=function(e){var a=de.biancoroyal.opcua.iiot.core.parseNamspaceFromMsgTopic(e),o=de.biancoroyal.opcua.iiot.core.parseIdentifierFromMsgTopic(e);return this.internalDebugLog("newOPCUANodeIdFromMsgTopic: "+JSON.stringify(o)),new de.biancoroyal.opcua.iiot.core.nodeOPCUAId.NodeId(o.type,o.identifier,a)},de.biancoroyal.opcua.iiot.core.pushItemToWriteList=function(e,a,o,t){var n=de.biancoroyal.opcua.iiot.core.nodeOPCUA;a.push({nodeId:this.newOPCUANodeIdFromItemNodeId(o),attributeId:n.AttributeIds.Value,indexRange:null,value:t})},de.biancoroyal.opcua.iiot.core.buildNodesToWrite=function(e){var a=[];this.detailDebugLog("buildNodesToWrite input: "+JSON.stringify(e));var o=null;if(!e.addressSpaceItems||!e.addressSpaceItems.length){var t=e.payload.nodesToWrite||e.nodesToWrite;t&&t.length&&(e.addressSpaceItems=t)}if(e.addressSpaceItems){var n=0;if(e.valuesToWrite){var i=!0,r=!1,c=void 0;try{for(var s,d=e.addressSpaceItems[Symbol.iterator]();!(i=(s=d.next()).done);i=!0)o=s.value,this.pushItemToWriteList(e,a,o,{value:this.buildNewVariant(o.datatypeName,e.valuesToWrite[n++])})}catch(e){r=!0,c=e}finally{try{i||null==d.return||d.return()}finally{if(r)throw c}}}else{var u=!0,l=!1,p=void 0;try{for(var y,b=e.addressSpaceItems[Symbol.iterator]();!(u=(y=b.next()).done);u=!0)(o=y.value).value?this.pushItemToWriteList(e,a,o,{value:this.buildNewVariant(o.datatypeName,o.value)}):this.pushItemToWriteList(e,a,o,{value:this.buildNewVariant(o.datatypeName,e.payload.length&&e.payload.length===e.addressSpaceItems.length?e.payload[n++]:e.payload)})}catch(e){l=!0,p=e}finally{try{u||null==b.return||b.return()}finally{if(l)throw p}}}}return this.internalDebugLog("buildNodesToWrite output: "+JSON.stringify(a)),a},de.biancoroyal.opcua.iiot.core.buildNodesToRead=function(e){var a=[],o=null;this.detailDebugLog("buildNodesToRead input: "+JSON.stringify(e));var t=e.payload.nodesToRead||e.payload.nodesToWrite;if(t&&t.length){var n=!0,i=!1,r=void 0;try{for(var c,s=t[Symbol.iterator]();!(n=(c=s.next()).done);n=!0)o=(o=c.value).nodeId||o,a.push(o.toString())}catch(e){i=!0,r=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw r}}}else{var d=e.nodesToRead||e.nodesToWrite;if(d&&d.length){var u=!0,l=!1,p=void 0;try{for(var y,b=d[Symbol.iterator]();!(u=(y=b.next()).done);u=!0)o=(o=y.value).nodeId||o,a.push(o.toString())}catch(e){l=!0,p=e}finally{try{u||null==b.return||b.return()}finally{if(l)throw p}}}else if(e.payload.addressSpaceItems&&e.payload.addressSpaceItems.length){var T=!0,g=!1,I=void 0;try{for(var h,N=e.payload.addressSpaceItems[Symbol.iterator]();!(T=(h=N.next()).done);T=!0)o=h.value,a.push(o.nodeId)}catch(e){g=!0,I=e}finally{try{T||null==N.return||N.return()}finally{if(g)throw I}}}else if(e.addressSpaceItems&&e.addressSpaceItems.length){var f=!0,m=!1,v=void 0;try{for(var S,D=e.addressSpaceItems[Symbol.iterator]();!(f=(S=D.next()).done);f=!0)o=S.value,a.push(o.nodeId)}catch(e){m=!0,v=e}finally{try{f||null==D.return||D.return()}finally{if(m)throw v}}}}return this.internalDebugLog("buildNodesToRead output: "+JSON.stringify(a)),a},de.biancoroyal.opcua.iiot.core.buildNodesToListen=function(e){return e.addressItemsToRead||e.addressSpaceItems},de.biancoroyal.opcua.iiot.core.buildNodesFromBrowser=function(e){return e.addressItemsToRead||e.addressSpaceItems},de.biancoroyal.opcua.iiot.core.buildNodeListFromClient=function(e){switch(e.nodetype){case"read":case"write":return this.buildNodesToRead(e);case"listen":return this.buildNodesToListen(e);case"browse":case"crawl":return this.buildNodesFromBrowser(e);default:return this.internalDebugLog("unknown node type injected to filter for "+e.nodetype),[]}},de.biancoroyal.opcua.iiot.core.availableMemory=function(){return this.os.freemem()/this.os.totalmem()*100},de.biancoroyal.opcua.iiot.core.isSessionBad=function(e){return e.toString().includes("Session")||e.toString().includes("Channel")||e.toString().includes("Transaction")||e.toString().includes("timeout")||e.toString().includes("Connection")},de.biancoroyal.opcua.iiot.core.setNodeInitalState=function(e,a){switch(e){case"INITOPCUA":case"SESSIONREQUESTED":this.setNodeStatusTo(a,"connecting");break;case"OPEN":case"SESSIONCLOSED":a.opcuaClient=a.connector.opcuaClient,this.setNodeStatusTo(a,"connected");break;case"SESSIONACTIVE":a.opcuaSession=a.connector.opcuaSession,this.setNodeStatusTo(a,"active");break;case"LOCKED":this.setNodeStatusTo(a,"locked");break;case"UNLOCKED":this.setNodeStatusTo(a,"unlocked");break;case"STOPPED":this.setNodeStatusTo(a,"stopped");break;case"END":this.setNodeStatusTo(a,"end");break;default:this.setNodeStatusTo(a,"waiting")}},de.biancoroyal.opcua.iiot.core.isNodeId=function(e){if(!e||!e.identifierType)return!1;switch(e.identifierType){case this.nodeOPCUA.NodeIdType.NUMERIC:case this.nodeOPCUA.NodeIdType.STRING:case this.nodeOPCUA.NodeIdType.GUID:return!0;default:return!1}},de.biancoroyal.opcua.iiot.core.checkConnectorState=function(e,a,o){return this.internalDebugLog("Check Connector State "+e.connector.stateMachine.getMachineState()+" By "+o),!e.connector||!e.connector.stateMachine||e.connector.stateMachine.getMachineState()===this.RUNNING_STATE||(this.internalDebugLog("Wrong Client State "+e.connector.stateMachine.getMachineState()+" By "+o),e.showErrors&&e.error(new Error("Client Not "+this.RUNNING_STATE+" On "+o),a),this.setNodeStatusTo(e,"not running"),e.emit("opcua_client_not_ready"),!1)},de.biancoroyal.opcua.iiot.core.setNodeOPCUAConnected=function(e,a){e.opcuaClient=a,this.setNodeStatusTo(e,"connecting")},de.biancoroyal.opcua.iiot.core.setNodeOPCUAClosed=function(e){e.opcuaClient=null,this.setNodeStatusTo(e,"disconnected")},de.biancoroyal.opcua.iiot.core.setNodeOPCUASessionStarted=function(e,a){e.opcuaSession=a,this.setNodeStatusTo(e,"active")},de.biancoroyal.opcua.iiot.core.setNodeOPCUASessionClosed=function(e){e.opcuaSession=null,this.setNodeStatusTo(e,"connecting")},de.biancoroyal.opcua.iiot.core.setNodeOPCUASessionRestart=function(e){this.setNodeStatusTo(e,"restart")},de.biancoroyal.opcua.iiot.core.setNodeOPCUASessionError=function(e){e.opcuaSession=null,this.setNodeStatusTo(e,"connecting")},de.biancoroyal.opcua.iiot.core.setNodeOPCUARestart=function(e,a){this.internalDebugLog("Connector Restart"),a&&(e.opcuaClient=a),this.setNodeStatusTo(e,"connecting")},de.biancoroyal.opcua.iiot.core.registerToConnector=function(a){var o=de.biancoroyal.opcua.iiot.core;a?a.connector?(a.connector.registerForOPCUA(a),a.connector.on("connector_init",function(){a.opcuaClient&&(a.opcuaClient=null),a.opcuaSession&&(a.opcuaSession=null)}),a.connector.on("connection_started",function(e){o.setNodeOPCUAConnected(a,e)}),a.connector.on("server_connection_close",function(){o.setNodeOPCUAClosed(a)}),a.connector.on("server_connection_abort",function(){o.setNodeOPCUAClosed(a)}),a.connector.on("connection_closed",function(){o.setNodeOPCUAClosed(a)}),a.connector.on("reset_opcua_connection",function(){o.setNodeOPCUASessionClosed(a)}),a.connector.on("session_started",function(e){o.setNodeOPCUASessionStarted(a,e)}),a.connector.on("session_closed",function(){o.setNodeOPCUASessionClosed(a)}),a.connector.on("session_restart",function(){o.setNodeOPCUAClosed(a)}),a.connector.on("session_error",function(){o.setNodeOPCUASessionError(a)}),a.connector.on("after_reconnection",function(){o.setNodeOPCUARestart(a)}),o.setNodeInitalState(a.connector.stateMachine.getMachineState(),a)):a.error(new Error("Connector Config Node Not Valid On Registering Client Node "+a.id),{payload:"No Connector Configured"}):o.internalDebugLog("Node Not Valid On Register To Connector")},de.biancoroyal.opcua.iiot.core.deregisterToConnector=function(e,a){var o=de.biancoroyal.opcua.iiot.core;return e?e.connector?void e.connector.deregisterForOPCUA(e,a):(e.error(new Error("Connector Not Valid On Register To Connector"),{payload:"No Connector Configured"}),void a()):(o.internalDebugLog("Node Not Valid On Register To Connector"),void a())},de.biancoroyal.opcua.iiot.core.checkSessionNotValid=function(e,a){return e?"terminated"===e.sessionId&&(this.internalDebugLog("Session Is Valid But Terminated On Check For "+a),!0):(this.internalDebugLog("Session Not Valid On Check For "+a),!0)},de.biancoroyal.opcua.iiot.core.setNodeStatusTo=function(e,a){var o=this.getNodeStatus(a,e.showStatusActivities);this.underscore.isEqual(e.oldStatusParameter,o)||(this.detailDebugLog("Node "+e.id+" Status To "+a),e.oldStatusParameter=o,e.status({fill:o.fill,shape:o.shape,text:o.status}))},de.biancoroyal.opcua.iiot.core.initClientNode=function(e){return e.reconnectTimeout=this.DEFAULT_TIMEOUT,e.sessionTimeout=null,e.opcuaSession=null,e.opcuaClient=null,e},de.biancoroyal.opcua.iiot.core.getItemFilterValueWithElement=function(e,a){var o=null;switch(a.name){case"browseName":case"statusCode":o=e[a.name].name;break;case"displayName":o=e[a.name].text;break;case"value":case"dataType":o=e.value&&e.value.hasOwnProperty("value")?e.value[a.name]:e[a.name];break;default:o=e[a.name]}return o},de.biancoroyal.opcua.iiot.core.handleErrorInsideNode=function(e,a){this.internalDebugLog(_typeof(e)+" "+a.message),e.showErrors&&e.error(a,{payload:a.message})},de.biancoroyal.opcua.iiot.core.checkCrawlerItemIsNotToFilter=function(a,e,o,t){try{var n=this.getItemFilterValueWithElement(e,o);n&&n.key&&n.key.match?n.key.match(o.value)&&(t&=!1):n&&n.match?n.match(o.value)&&(t&=!1):n&&n.toString&&(n=n.toString())&&n.match&&n.match(o.value)&&(t&=!1)}catch(e){this.handleErrorInsideNode(a,e)}return t},de.biancoroyal.opcua.iiot.core.checkResponseItemIsNotToFilter=function(a,e,o,t){try{var n=this.getItemFilterValueWithElement(e,o);n?n.key&&n.key.match?t&=null!==n.key.match(o.value):n.match?t&=null!==n.match(o.value):n.toString&&(n=n.toString()).match&&(t&=null!==n.match(o.value)):t&=!1}catch(e){this.handleErrorInsideNode(a,e)}return t},de.biancoroyal.opcua.iiot.core.checkItemForUnsetState=function(e,a){var o=!0;return e.activateUnsetFilter&&(o&=null!==a,a&&a.hasOwnProperty("value")&&(a.value&&a.value.hasOwnProperty("value")?o&=null!==a.value.value:o&=null!==a.value)),o},module.exports=de.biancoroyal.opcua.iiot.core;
//# sourceMappingURL=../maps/core/opcua-iiot-core.js.map
